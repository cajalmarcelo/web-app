{"ast":null,"code":"import React,{useEffect}from\"react\";import CircularLoading from\"../components/CircularLoading\";import{useSelector,useDispatch}from\"react-redux\";import{api}from\"common\";import i18n from\"i18next\";import{useTranslation}from\"react-i18next\";import moment from\"moment/min/moment-with-locales\";import{jsx as _jsx}from\"react/jsx-runtime\";function AuthLoading(props){const{t}=useTranslation();const{fetchUser,fetchCarTypes,fetchSettings,fetchBookings,fetchCancelReasons,fetchPromos,fetchDriverEarnings,fetchUsers,fetchNotifications,fetchEarningsReport,signOff,fetchWithdraws,fetchPaymentMethods,fetchLanguages,fetchWalletHistory,fetchCars,fetchComplain,fetchSMTP,fetchSos,fetchSMSConfig,fetchFleetAdminEarnings}=api;const dispatch=useDispatch();const auth=useSelector(state=>state.auth);const languagedata=useSelector(state=>state.languagedata);const settingsdata=useSelector(state=>state.settingsdata);useEffect(()=>{dispatch(fetchSettings());},[dispatch,fetchSettings]);useEffect(()=>{let obj={};let def1={};if(languagedata.langlist){for(const value of Object.values(languagedata.langlist)){obj[value.langLocale]=value.keyValuePairs;if(value.default===true){def1=value;break;}}if(def1&&def1.langLocale){const result=localStorage.getItem('lang');if(result){let langLocale=JSON.parse(result)['langLocale'];let dateLocale=JSON.parse(result)['dateLocale'];i18n.addResourceBundle(langLocale,\"translations\",obj[langLocale]);i18n.changeLanguage(langLocale);moment.locale(dateLocale);}else{i18n.addResourceBundle(def1.langLocale,\"translations\",obj[def1.langLocale]);i18n.changeLanguage(def1.langLocale);moment.locale(def1.dateLocale);}}dispatch(fetchUser());}},[languagedata,dispatch,fetchUser]);useEffect(()=>{if(settingsdata.settings){dispatch(fetchLanguages());dispatch(fetchCarTypes());document.title=settingsdata.settings.appName;}},[settingsdata.settings,dispatch,fetchLanguages,fetchCarTypes]);useEffect(()=>{if(auth.profile){if(auth.profile.usertype){let role=auth.profile.usertype;if(role===\"customer\"){dispatch(fetchBookings());dispatch(fetchWalletHistory());dispatch(fetchPaymentMethods());dispatch(fetchCancelReasons());dispatch(fetchUsers());}else if(role===\"driver\"){dispatch(fetchBookings());dispatch(fetchWithdraws());dispatch(fetchPaymentMethods());dispatch(fetchCars());dispatch(fetchWalletHistory());}else if(role===\"admin\"){dispatch(fetchUsers());dispatch(fetchBookings());dispatch(fetchPromos());dispatch(fetchDriverEarnings());dispatch(fetchFleetAdminEarnings());dispatch(fetchNotifications());dispatch(fetchEarningsReport());dispatch(fetchCancelReasons());dispatch(fetchWithdraws());dispatch(fetchComplain());dispatch(fetchPaymentMethods());dispatch(fetchCars());dispatch(fetchSMTP());dispatch(fetchSMSConfig());dispatch(fetchSos());}else if(role===\"fleetadmin\"){dispatch(fetchUsers());dispatch(fetchBookings());dispatch(fetchDriverEarnings());dispatch(fetchCars());dispatch(fetchCancelReasons());dispatch(fetchPaymentMethods());dispatch(fetchWalletHistory());}else{alert(t(\"not_valid_user_type\"));dispatch(signOff());}}else{alert(t(\"user_issue_contact_admin\"));dispatch(signOff());}}},[auth.profile,dispatch,fetchBookings,fetchCancelReasons,fetchDriverEarnings,fetchEarningsReport,fetchNotifications,fetchPromos,fetchUsers,fetchWithdraws,signOff,fetchPaymentMethods,fetchWalletHistory,fetchCars,fetchComplain,fetchSMTP,fetchSMSConfig,fetchSos,fetchFleetAdminEarnings,t]);return settingsdata.loading?/*#__PURE__*/_jsx(CircularLoading,{}):settingsdata.settings?auth.loading||!languagedata.langlist?/*#__PURE__*/_jsx(CircularLoading,{}):props.children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"span\",{children:\"No Database Settings found\"})});}export default AuthLoading;","map":{"version":3,"names":["React","useEffect","CircularLoading","useSelector","useDispatch","api","i18n","useTranslation","moment","jsx","_jsx","AuthLoading","props","t","fetchUser","fetchCarTypes","fetchSettings","fetchBookings","fetchCancelReasons","fetchPromos","fetchDriverEarnings","fetchUsers","fetchNotifications","fetchEarningsReport","signOff","fetchWithdraws","fetchPaymentMethods","fetchLanguages","fetchWalletHistory","fetchCars","fetchComplain","fetchSMTP","fetchSos","fetchSMSConfig","fetchFleetAdminEarnings","dispatch","auth","state","languagedata","settingsdata","obj","def1","langlist","value","Object","values","langLocale","keyValuePairs","default","result","localStorage","getItem","JSON","parse","dateLocale","addResourceBundle","changeLanguage","locale","settings","document","title","appName","profile","usertype","role","alert","loading","children"],"sources":["C:/Users/CAJAL/Desktop/main/Sourcecode/web-app/src/views/AuthLoading.js"],"sourcesContent":["import React, { useEffect } from \"react\";\nimport CircularLoading from \"../components/CircularLoading\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { api } from \"common\";\nimport i18n from \"i18next\";\nimport { useTranslation } from \"react-i18next\";\nimport moment from \"moment/min/moment-with-locales\";\n\nfunction AuthLoading(props) {\n  const { t } = useTranslation();\n  const {\n    fetchUser,\n    fetchCarTypes,\n    fetchSettings,\n    fetchBookings,\n    fetchCancelReasons,\n    fetchPromos,\n    fetchDriverEarnings,\n    fetchUsers,\n    fetchNotifications,\n    fetchEarningsReport,\n    signOff,\n    fetchWithdraws,\n    fetchPaymentMethods,\n    fetchLanguages,\n    fetchWalletHistory,\n    fetchCars,\n    fetchComplain,\n    fetchSMTP,\n    fetchSos,\n    fetchSMSConfig,\n    fetchFleetAdminEarnings\n  } = api;\n  const dispatch = useDispatch();\n  const auth = useSelector((state) => state.auth);\n  const languagedata = useSelector((state) => state.languagedata);\n  const settingsdata = useSelector((state) => state.settingsdata);\n\n  useEffect(() => {\n    dispatch(fetchSettings());\n  }, [dispatch, fetchSettings]);\n\n  useEffect(() => {\n    let obj = {};\n    let def1 = {};\n    if (languagedata.langlist) {\n      for (const value of Object.values(languagedata.langlist)) {\n        obj[value.langLocale] = value.keyValuePairs;\n        if (value.default === true) {\n          def1 = value;\n          break;\n        }\n      }\n      if(def1 && def1.langLocale){\n        const result = localStorage.getItem('lang');\n        if (result) {\n          let langLocale = JSON.parse(result)['langLocale'];\n          let dateLocale = JSON.parse(result)['dateLocale'];\n          i18n.addResourceBundle(\n            langLocale,\n            \"translations\",\n            obj[langLocale]\n          );\n          i18n.changeLanguage(langLocale);\n          moment.locale(dateLocale);\n        } else {\n          i18n.addResourceBundle(\n            def1.langLocale,\n            \"translations\",\n            obj[def1.langLocale]\n          );\n          i18n.changeLanguage(def1.langLocale);\n          moment.locale(def1.dateLocale);\n        }\n      }\n\n      dispatch(fetchUser());\n    }\n  }, [languagedata, dispatch, fetchUser]);\n\n  useEffect(() => {\n    if (settingsdata.settings) {\n      dispatch(fetchLanguages());\n      dispatch(fetchCarTypes());\n      document.title = settingsdata.settings.appName;\n    }\n  }, [settingsdata.settings, dispatch, fetchLanguages, fetchCarTypes]);\n\n  useEffect(() => {\n    if (auth.profile) {\n      if (auth.profile.usertype) {\n        let role = auth.profile.usertype;\n        if (role === \"customer\") {\n          dispatch(fetchBookings());\n          dispatch(fetchWalletHistory());\n          dispatch(fetchPaymentMethods());\n          dispatch(fetchCancelReasons());\n          dispatch(fetchUsers());\n        } else if (role === \"driver\") {\n          dispatch(fetchBookings());\n          dispatch(fetchWithdraws());\n          dispatch(fetchPaymentMethods());\n          dispatch(fetchCars());\n          dispatch(fetchWalletHistory());\n        } else if (role === \"admin\") {\n          dispatch(fetchUsers());\n          dispatch(fetchBookings());\n          dispatch(fetchPromos());\n          dispatch(fetchDriverEarnings());\n          dispatch(fetchFleetAdminEarnings());\n          dispatch(fetchNotifications());\n          dispatch(fetchEarningsReport());\n          dispatch(fetchCancelReasons());\n          dispatch(fetchWithdraws());\n          dispatch(fetchComplain());\n          dispatch(fetchPaymentMethods());\n          dispatch(fetchCars());\n          dispatch(fetchSMTP());\n          dispatch(fetchSMSConfig());\n          dispatch(fetchSos());\n        } else if (role === \"fleetadmin\") {\n          dispatch(fetchUsers());\n          dispatch(fetchBookings());\n          dispatch(fetchDriverEarnings());\n          dispatch(fetchCars());\n          dispatch(fetchCancelReasons());\n          dispatch(fetchPaymentMethods());\n          dispatch(fetchWalletHistory());\n        } else {\n          alert(t(\"not_valid_user_type\"));\n          dispatch(signOff());\n        }\n      } else {\n        alert(t(\"user_issue_contact_admin\"));\n        dispatch(signOff());\n      }\n    }\n  }, [\n    auth.profile,\n    dispatch,\n    fetchBookings,\n    fetchCancelReasons,\n    fetchDriverEarnings,\n    fetchEarningsReport,\n    fetchNotifications,\n    fetchPromos,\n    fetchUsers,\n    fetchWithdraws,\n    signOff,\n    fetchPaymentMethods,\n    fetchWalletHistory,\n    fetchCars,\n    fetchComplain,\n    fetchSMTP,\n    fetchSMSConfig,\n    fetchSos,\n    fetchFleetAdminEarnings,\n    t\n  ]);\n\n  return settingsdata.loading ? (\n    <CircularLoading />\n  ) : settingsdata.settings ? (\n    auth.loading || !languagedata.langlist ? (\n      <CircularLoading />\n    ) : (\n      props.children\n    )\n  ) : (\n    <div>\n      <span>No Database Settings found</span>\n  </div>\n  );\n}\n\nexport default AuthLoading;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}