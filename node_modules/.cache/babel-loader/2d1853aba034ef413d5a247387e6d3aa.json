{"ast":null,"code":"import{FETCH_NOTIFICATIONS,FETCH_NOTIFICATIONS_SUCCESS,FETCH_NOTIFICATIONS_FAILED,EDIT_NOTIFICATIONS,SEND_NOTIFICATION,SEND_NOTIFICATION_SUCCESS,SEND_NOTIFICATION_FAILED}from\"../store/types\";import{RequestPushMsg}from'../other/NotificationFunctions';import{firebase}from'../config/configureFirebase';import{onValue,set,push,remove}from\"firebase/database\";import store from'../store/store';export const fetchUserNotifications=()=>dispatch=>{const{auth,userNotificationsRef}=firebase;dispatch({type:FETCH_NOTIFICATIONS,payload:null});const uid=auth.currentUser.uid;onValue(userNotificationsRef(uid),snapshot=>{const data=snapshot.val();if(data){const arr=Object.keys(data).map(i=>{data[i].id=i;return data[i];});dispatch({type:FETCH_NOTIFICATIONS_SUCCESS,payload:arr.reverse()});}else{dispatch({type:FETCH_NOTIFICATIONS_FAILED,payload:\"No data available.\"});}});};export const fetchNotifications=()=>dispatch=>{const{notifyRef}=firebase;dispatch({type:FETCH_NOTIFICATIONS,payload:null});onValue(notifyRef,snapshot=>{if(snapshot.val()){const data=snapshot.val();const arr=Object.keys(data).map(i=>{data[i].id=i;return data[i];});dispatch({type:FETCH_NOTIFICATIONS_SUCCESS,payload:arr});}else{dispatch({type:FETCH_NOTIFICATIONS_FAILED,payload:\"No data available.\"});}});};export const editNotifications=(notification,method)=>dispatch=>{const{notifyRef,notifyEditRef}=firebase;dispatch({type:EDIT_NOTIFICATIONS,payload:{method,notification}});if(method==='Add'){push(notifyRef,notification);}else if(method==='Delete'){remove(notifyEditRef(notification.id));}else{set(notifyEditRef(notification.id),notification);}};export const sendNotification=notification=>async dispatch=>{const{config}=firebase;dispatch({type:SEND_NOTIFICATION,payload:notification});const settings=store.getState().settingsdata.settings;let host=window&&window.location&&settings.CompanyWebsite===window.location.origin?window.location.origin:\"https://\".concat(config.projectId,\".web.app\");let url=\"\".concat(host,\"/send_notification\");fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({\"notification\":notification})});};","map":{"version":3,"names":["FETCH_NOTIFICATIONS","FETCH_NOTIFICATIONS_SUCCESS","FETCH_NOTIFICATIONS_FAILED","EDIT_NOTIFICATIONS","SEND_NOTIFICATION","SEND_NOTIFICATION_SUCCESS","SEND_NOTIFICATION_FAILED","RequestPushMsg","firebase","onValue","set","push","remove","store","fetchUserNotifications","dispatch","auth","userNotificationsRef","type","payload","uid","currentUser","snapshot","data","val","arr","Object","keys","map","i","id","reverse","fetchNotifications","notifyRef","editNotifications","notification","method","notifyEditRef","sendNotification","config","settings","getState","settingsdata","host","window","location","CompanyWebsite","origin","concat","projectId","url","fetch","headers","body","JSON","stringify"],"sources":["C:/Users/CAJAL/Desktop/main/Sourcecode/common/src/actions/notificationactions.js"],"sourcesContent":["import {\n  FETCH_NOTIFICATIONS,\n  FETCH_NOTIFICATIONS_SUCCESS,\n  FETCH_NOTIFICATIONS_FAILED,\n  EDIT_NOTIFICATIONS,\n  SEND_NOTIFICATION,\n  SEND_NOTIFICATION_SUCCESS,\n  SEND_NOTIFICATION_FAILED,\n} from \"../store/types\";\nimport { RequestPushMsg } from '../other/NotificationFunctions';\nimport { firebase } from '../config/configureFirebase';\nimport { onValue, set, push, remove } from \"firebase/database\";\nimport store from '../store/store';\n\nexport const fetchUserNotifications = () => (dispatch) => {\n\n  const {\n    auth,\n    userNotificationsRef\n  } = firebase;\n\n  dispatch({\n    type: FETCH_NOTIFICATIONS,\n    payload: null\n  });\n\n  const uid = auth.currentUser.uid;\n\n  onValue(userNotificationsRef(uid), snapshot => {\n    const data = snapshot.val(); \n    if(data){\n      const arr = Object.keys(data).map(i => {\n        data[i].id = i\n        return data[i]\n      });\n      dispatch({\n        type: FETCH_NOTIFICATIONS_SUCCESS,\n        payload: arr.reverse()\n      });\n    } else {\n      dispatch({\n        type: FETCH_NOTIFICATIONS_FAILED,\n        payload: \"No data available.\"\n      });\n    }\n  });\n};\n\nexport const fetchNotifications = () => (dispatch) => {\n\n  const {\n    notifyRef\n  } = firebase;\n\n  dispatch({\n    type: FETCH_NOTIFICATIONS,\n    payload: null\n  });\n  onValue(notifyRef, snapshot => {\n    if (snapshot.val()) {\n      const data = snapshot.val();\n\n      const arr = Object.keys(data).map(i => {\n        data[i].id = i\n        return data[i]\n      });\n\n      dispatch({\n        type: FETCH_NOTIFICATIONS_SUCCESS,\n        payload: arr\n      });\n    } else {\n      dispatch({\n        type: FETCH_NOTIFICATIONS_FAILED,\n        payload: \"No data available.\"\n      });\n    }\n  });\n};\n\nexport const editNotifications = (notification, method) => (dispatch) => {\n  const {\n    notifyRef,\n    notifyEditRef\n  } = firebase;\n  dispatch({\n    type: EDIT_NOTIFICATIONS,\n    payload: { method, notification }\n  });\n  if (method === 'Add') {\n    push(notifyRef, notification);\n  } else if (method === 'Delete') {\n    remove(notifyEditRef(notification.id));\n  } else {\n    set(notifyEditRef(notification.id), notification);\n  }\n}\n\nexport const sendNotification = (notification) => async (dispatch) => {\n\n  const {\n    config\n  } = firebase;\n\n  dispatch({\n    type: SEND_NOTIFICATION,\n    payload: notification\n  });\n\n  const settings = store.getState().settingsdata.settings;\n  let host = window && window.location && settings.CompanyWebsite === window.location.origin? window.location.origin : `https://${config.projectId}.web.app`\n  let url = `${host}/send_notification`;\n\n  fetch(url, {\n      method: 'POST',\n      headers: {\n          'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n          \"notification\": notification\n      })\n  });\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}